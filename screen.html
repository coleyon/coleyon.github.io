
<!DOCTYPE html>

<html lang="ja">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="index, follow" name="robots"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<!-- <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap" rel="stylesheet"> -->
<link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100;300;700&amp;family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&amp;display=swap" rel="stylesheet"/>
<link href="https://coleyon.github.io/theme/stylesheet/style.less" rel="stylesheet/less" type="text/css"/>
<script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.1/less.min.js" type="text/javascript"></script>
<link href="https://coleyon.github.io/theme/pygments/github.min.css" id="pygments-light-theme" rel="stylesheet" type="text/css"/>
<link href="https://coleyon.github.io/theme/tipuesearch/tipuesearch.min.css" rel="stylesheet">
<link href="https://coleyon.github.io/theme/font-awesome/css/fontawesome.css" rel="stylesheet" type="text/css"/>
<link href="https://coleyon.github.io/theme/font-awesome/css/brands.css" rel="stylesheet" type="text/css"/>
<link href="https://coleyon.github.io/theme/font-awesome/css/solid.css" rel="stylesheet" type="text/css"/>
<link href="https://coleyon.github.io/static/custom.css" rel="stylesheet"/>
<link href="https://coleyon.github.io/feeds/all.atom.xml" rel="alternate" title="wof Atom" type="application/atom+xml"/>
<link href="https://coleyon.github.io/images/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
<link href="https://coleyon.github.io/images/favicon.ico" rel="icon" type="image/x-icon"/>
<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'G-RCE39CRW4N', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
<meta content="coleyon" name="author"/>
<meta content="Screenコマンドを使うと、Linuxコンソールを複数ユーザセッション間で共有できます。" name="description"/>
<meta content="linux, screen, terminal" name="keywords"/>
<meta content="wof" property="og:site_name">
<meta content="screen コマンドを使った linux terminal セッション共有" property="og:title"/>
<meta content="Screenコマンドを使うと、Linuxコンソールを複数ユーザセッション間で共有できます。" property="og:description"/>
<meta content="ja_JP" property="og:locale"/>
<meta content="https://coleyon.github.io/screen.html" property="og:url"/>
<meta content="article" property="og:type"/>
<meta content="2017-10-22 12:00:00+09:00" property="article:published_time"/>
<meta content="2017-10-22 12:00:00+09:00" property="article:modified_time"/>
<meta content="https://coleyon.github.io/author/coleyon.html" property="article:author"/>
<meta content="howto" property="article:section">
<meta content="linux" property="article:tag"/>
<meta content="screen" property="article:tag"/>
<meta content="terminal" property="article:tag"/>
<meta content="https://coleyon.github.io/images/profile.png" property="og:image"/>
<title>wof – screen コマンドを使った linux terminal セッション共有</title>
<script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-8759671048737588",
      enable_page_level_ads: true
    });
  </script>
<!-- Google Tag Manager -->
<script>
  (function(w,d,s,l,i){
    w[l]=w[l]||[];
    w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
    j.async=true;
    j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
    f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-MFGZCPR');
</script>
<!-- End Google Tag Manager --></meta></meta></link></head>
<body class="light-theme">
<!-- Google Tag Manager -->
<noscript>
<iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-MFGZCPR" style="display:none;visibility:hidden" width="0"></iframe>
</noscript>
<!-- End Google Tag Manager --> <aside>
<div>
<h1>
<a href="https://coleyon.github.io">wof</a>
</h1>
<p>Techblog</p>
<form action="/search.html" class="navbar-search" role="search">
<input id="tipue_search_input" name="q" placeholder="Search..." type="text"/>
</form>
<ul class="social">
<li>
<a class="sc-github" href="https://github.com/coleyon/" target="_blank">
<i class="fab fa-github"></i>
</a>
</li>
</ul>
</div>
<script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle ads-aside" data-ad-client="ca-pub-8759671048737588" data-ad-slot="1234561"></ins>
<script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
</aside>
<main>
<nav>
<a href="https://coleyon.github.io">Home</a>
<a href="/archives.html">Archives</a>
<a href="/categories.html">Categories</a>
<a href="/tags.html">Tags</a>
<a href="https://coleyon.github.io/feeds/all.atom.xml">Atom</a>
</nav>
<article class="single">
<header>
<h1 id="screen">screen コマンドを使った linux terminal セッション共有</h1>
<p>
      Posted on 2017-10-22 (日) in <a href="https://coleyon.github.io/category/howto.html">howto</a>
</p>
</header>
<div>
<p>Screen コマンドを使うと、Linux コンソールを複数ユーザセッション間で共有できます。</p>
<ul>
<li>参考<ul>
<li>みやすい概要<ul>
<li><a href="https://mistymagich.wordpress.com/2011/11/08/multiuser_screen_command">https://mistymagich.wordpress.com/2011/11/08/multiuser_screen_command</a></li>
</ul>
</li>
<li>multiuser mode 権限制御系操作<ul>
<li><a href="http://aperiodic.net/screen/multiuser">http://aperiodic.net/screen/multiuser</a></li>
</ul>
</li>
</ul>
</li>
<li>ユースケース<ul>
<li>Dev チームのペアプログラミングよろしく、Ops チームにも部下育成やダブルチェックを兼ねて、Linux サーバオペレーションを複数名で行う場合があります。そんな時は、物理コンソールに人が集まって行うのもよいですが、ターミナルのセッションを SSH で皆が共有できる Screen を使うと捗ります。</li>
</ul>
</li>
<li>環境例<ul>
<li>Debian Jessie +</li>
<li>共有元ユーザ : parent</li>
<li>共有先ユーザ : child</li>
</ul>
</li>
</ul>
<h1>事前準備</h1>
<ul>
<li>screen インストール</li>
</ul>
<div class="highlight"><pre><span></span><code>sudoer@test:~$ sudo apt-get update <span class="o">&amp;&amp;</span> sudo apt-get install screen
</code></pre></div>
<ul>
<li>screen セッションを各ユーザで共有可能にする設定</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">## sudoer console</span>
sudoer@test:~$ sudo chmod u+s /usr/bin/screen
sudoer@test:~$ sudo chmod <span class="m">755</span> /var/run/screen
</code></pre></div>
<h1>セッション公開</h1>
<ul>
<li>screen セッション share を立てる</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">## parent console</span>
parent@test:~$ screen -S share
</code></pre></div>
<ul>
<li>child ユーザへ share セッションを共有する</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">## parent console</span>
parent@test:~$
<span class="o">(</span>Ctrl+a<span class="o">)</span> 
:multiuser on
Multiuser mode enabled
parent@test:~$
<span class="o">(</span>Ctrl+a<span class="o">)</span> 
:acladd child
parent@test:~$
</code></pre></div>
<h1>セッション参加</h1>
<ul>
<li>parent ユーザが立てた screen のセッション名を確認し、乗り込む</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">## child console</span>
child@test:~$ screen -ls parent/
There is a suitable screen on:
        <span class="m">1448</span>.share      <span class="o">(</span><span class="m">03</span>/07/2017 <span class="m">10</span>:49:09 AM<span class="o">)</span>        <span class="o">(</span>Multi, attached<span class="o">)</span>
<span class="m">1</span> Socket <span class="k">in</span> /var/run/screen/S-parent.
child@test:~$ screen -x parent/share
</code></pre></div>
<h1>ログアウトとデタッチの動作</h1>
<ul>
<li>parent ユーザが screen セッションとして起動されている login セッションからログアウトする</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">## parent console</span>
parent@test:~$ <span class="nb">exit</span>
<span class="o">[</span>screen is terminating<span class="o">]</span>
parent@test:~$
</code></pre></div>
<ul>
<li>child ユーザが screen セッションとして起動されている login セッションからログアウトする</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">## child console</span>
parent@test:~$ <span class="nb">exit</span>
<span class="o">[</span>screen is terminating<span class="o">]</span>
child@test:~$
</code></pre></div>
<ul>
<li>parent ユーザが screen セッション share をデタッチする</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">## parent console</span>
parent@test:~$
<span class="o">(</span>Ctrl+A<span class="o">)</span> <span class="o">(</span>d<span class="o">)</span>
<span class="o">[</span>detached from <span class="m">1448</span>.share<span class="o">]</span>
parent@test:~$
</code></pre></div>
<ul>
<li>child ユーザが screen セッション share をデタッチする</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">## child console</span>
parent@test:~$
<span class="o">(</span>Ctrl+A<span class="o">)</span> <span class="o">(</span>d<span class="o">)</span>
<span class="o">[</span>detached from <span class="m">1448</span>.share<span class="o">]</span>
child@test:~$
</code></pre></div>
</div>
<div class="tag-cloud">
<p>
<a href="https://coleyon.github.io/tag/linux.html">linux</a>
<a href="https://coleyon.github.io/tag/screen.html">screen</a>
<a href="https://coleyon.github.io/tag/terminal.html">terminal</a>
</p>
</div>
<script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle ads-responsive" data-ad-client="ca-pub-8759671048737588" data-ad-slot="1234566"></ins>
<script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'coleyon-dev';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>
<footer>
<p>
  © 2021  - This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" rel="license" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p><p>
<a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="license" target="_blank">
<img alt="Creative Commons License" height="15" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" style="border-width:0" title="Creative Commons License" width="80"/>
</a>
</p> </footer>
</main>
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " wof ",
  "url" : "https://coleyon.github.io",
  "image": "https://coleyon.github.io/images/profile.png",
  "description": "subdescr"
}
</script>
</body>
</html>